package com.intiformation;

import java.util.ArrayList;
import java.util.Scanner;

public class Main
{
	static ArrayList<Medicament> listeMedicament = new ArrayList<Medicament>();
	static ArrayList<Client> listeClient = new ArrayList<Client>();
	static int compteur = 0;

	public static void main(String[] args)
	{
		Scanner sc = new Scanner(System.in);

		System.out.println(""
				+ "Veuillez sélectionner le programme que vous souhaitez : \n"
				+ "1. Création d'un nouveau client dans la base de données. \n" + "2. Afficher les infos d'un client. \n"
				+ "3. Ajout d'un médicament dans la base de données. \n" + "4. Afficher les infos d'un médicament. \n"
				+ "5. Restock d'un médicament. \n" + "6. Vente d'un médicament. \n" + "7. Quitter. \n ");

		int key = sc.nextInt();
		switch (key)
			{
			case 1: // Création d'un nouveau client
			double crédit = 0;
			creationClient(crédit);
				break;

			case 2: // Affichage des informations client
				infosClient();
				break;

			case 3: // ajout d'un nouveau médicament
				ajoutMedicament();
				break;

			case 4: // Affichage des informations médicament
				infosMedicament();
				break;

			case 5: // Restock des médicaments
				restockMedicament();
				break;

			case 6: // Vente des medicaments
				venteMedicament();
				break;

			case 7: // Fermeture du logiciel
				quitter();
				break;

			default:
				break;
			}
		sc.close();
	}

	public static void creationClient(double crédit) // Fonction 1
	{
		Scanner sc = new Scanner(System.in);
		Client c1 = new Client();

		System.out.print("Création de client - Votre Nom : ");
		c1.setNom(sc.next());
		c1.setId(compteur++);
		System.out.print("Création de client - Choix du crédit à pourvoir à votre pharmacie : ");
		c1.setCrédit(crédit + sc.nextDouble());

		listeClient.add(c1);
		System.out.println("Nouveau client ajouté : " + c1.getNom() + " : " + c1.toString()
				+ ". Votre crédit s'élève à : " + c1.getCrédit() + "€.");

		main(null);
		sc.close();
	}

	private static void infosClient() // Fonction 2
	{
		System.out.println("Liste des clients : " + listeClient);
		System.out.print("Choisir l'id du client à afficher : ");

		Scanner sc = new Scanner(System.in);
		int idMod = sc.nextInt();

		boolean isTrouver = false;
		for (int i = 0; i < listeClient.size(); i++)
		{
			if (listeClient.get(i).getId() == idMod)
			{
				isTrouver = true;
				System.out.println(listeClient.get(i));
			}

		}
		if (isTrouver == false)
		{
			System.out.println("Aucun client ne correspondant à cet id.");
		}

		main(null);
		sc.close();

	}

	public static void ajoutMedicament() // Fonction 3
	{
		Scanner sc = new Scanner(System.in);
		Medicament m1 = new Medicament();

		System.out.print("Création de médicament - Nom du médicament : ");
		m1.setNom(sc.next());
		m1.setId(compteur++);
		System.out.print("Combien de stock voulez vous rajouter? ");
		m1.setStock(sc.nextInt());
		System.out.print("Quel est le prix unitaire de ce médicament? ");
		m1.setPrix(sc.nextDouble());
		

		listeMedicament.add(m1);
		System.out.println("Nouveau médicament ajouté : " + m1.getNom() + " : " + m1.getStock() + " Prix unitaire : " + m1.getPrix() + " Coût total du stock : " + m1.getStock()*m1.getPrix());

		main(null);
		sc.close();
	}

	private static void infosMedicament() // Fonction 4
	{
		System.out.println("Liste des médicaments : " + listeMedicament);
		System.out.print("Choisir l'id du médicament à afficher : ");

		Scanner sc = new Scanner(System.in);
		int idMod = sc.nextInt();

		boolean isTrouver = false;
		for (int i = 0; i < listeMedicament.size(); i++)
		{
			if (listeMedicament.get(i).getId() == idMod)
			{
				isTrouver = true;
				System.out.println(listeMedicament.get(i));
			}

		}
		if (isTrouver == false)
		{
			System.out.println("Aucun médicament ne correspondant à cet id.");
		}

		sc.close();
		main(null);
	}

	private static void restockMedicament() // Fonction 5
	{
		System.out.println("Liste des médicaments : " + listeMedicament);
		System.out.print("Choisir l'id du médicament à restocker : ");

		Scanner sc = new Scanner(System.in);
		int idMod = sc.nextInt();

		boolean isTrouver = false;
		for (int i = 0; i < listeMedicament.size(); i++)
		{
			isTrouver = true;

			if (listeMedicament.get(i).getId() == idMod)
			{
				System.out.println(
						"Stock actuel : " + listeMedicament.get(i).getStock() + "Saississez la quantité à rajouter : ");
				listeMedicament.get(i).setStock(sc.nextInt());
				System.out.println("Stock désormais : " + listeMedicament.get(i).getStock());
			}

			if (isTrouver == false)
			{
				System.out.println("Aucun médicament ne correspondant à cet id.");
			}

			sc.close();
			main(null);
		}
	}

	private static void venteMedicament() // Fonction 6
	{
		Scanner sc = new Scanner(System.in);
		
		System.out.println("Liste des clients : " + listeClient);
		System.out.print("Choisir l'id du client à qui vendre le médicament : ");
		int idClient = sc.nextInt();
		
		System.out.println("Liste des médicaments : " + listeMedicament);
		System.out.print("Choisir l'id du médicament que vous voulez vendre : ");
		int idMed = sc.nextInt();
		
		System.out.print("Choisir la quantité (en unité) du médicament que vous voulez vendre : ");
		int qt = sc.nextInt();
		
		for (int i = 0; i < listeClient.size(); i++) 
		{
			if (listeClient.get(i).getId() == idClient)
			{
				for (int j = 0; j < listeMedicament.size(); j++)
				{
					if (listeMedicament.get(j).getId() == idMed && listeClient.get(i).getCrédit() > listeMedicament.get(j).getPrix()*qt)
					{
						listeMedicament.get(j).setStock(listeMedicament.get(j).getStock() - qt);
						listeClient.get(i).setCrédit(listeClient.get(i).getCrédit() - listeMedicament.get(j).getPrix()*qt);
						System.out.println("Le crédit du client " + listeClient.get(i).getNom() + " s'élève désormais à " + listeClient.get(i).getCrédit() + "€.");
						System.out.println("Le stock est désormais de : " + listeMedicament.get(i).getStock() + " unités. ");
					}
					
					else
					{
						System.out.println("Aucun médicament ne correspond à cet id ou fonds insuffisant");
					}
				}
			}
			
			else
			{
				System.out.println("Aucun client ne correspond à cet id.");
			}
		}
		main(null);
		sc.close();
	}
	
	private static void quitter() // Fonction 7
	{
		System.out.println("[Fin de l'application] Bonne journée à vous et à bientôt.");
	}

}
